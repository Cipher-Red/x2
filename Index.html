<!Doctype html>
<html>
<head>
<title>X2</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseUrl = "https://njhqyhduenphvvhvulwb.supabase.co";
  const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5qaHF5aGR1ZW5waHZ2aHZ1bHdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5MDczNTAsImV4cCI6MjA3OTQ4MzM1MH0.6wfk6Nt_USzJgfA2Exv6w2PzvM6EFazGREfhizrpTks";
  const db = supabase.createClient(supabaseUrl, supabaseKey);

  async function countOrderNumbers() {
    // Option 1: Use count with head:true to get only the count
    const { count, error } = await db
      .from('Data_Ref')
      .select('*', { count: 'exact', head: true })
      .not('Order_Number', 'is', null);

    if (error) {
      console.error("Supabase error:", error);
      document.getElementById("result").textContent = "Error fetching data: " + error.message;
      return;
    }

    console.log("Non-null order numbers:", count);
    document.getElementById("result").textContent = "Refund Orders: " + (count || 0);
  }

  // Alternative function that fetches actual data
  async function countOrderNumbersWithData() {
    const { data, count, error } = await db
      .from('Data_Ref')
      .select('Order_Number', { count: 'exact' })
      .not('Order_Number', 'is', null);

    if (error) {
      console.error("Supabase error:", error);
      document.getElementById("result").textContent = "Error fetching data: " + error.message;
      return;
    }

    console.log("Count:", count);
    console.log("Data rows:", data ? data.length : 0);
    console.log("Sample data:", data);
    
    document.getElementById("result").textContent = "Order numbers: " + (count || 0);
  }

  // Run when page loads
  window.addEventListener('DOMContentLoaded', () => {
    countOrderNumbers();
  });
</script>

</head>
<style>

@import url('https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300&display=swap');
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css');

.fa-2x {
  font-size: 2em;
}

.fa {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 60px;
  height: 36px;
  font-size: 20px;
}

.main-menu {
  background: #73AF6F;
  border-right: 1px solid #e5e5e5;
  position: fixed;
  top: 0;
  left: 0;
  height: 100%;
  width: 60px;
  overflow: hidden;
  transition: width 0.2s ease-in-out;
  z-index: 1000;
}

.main-menu:hover,
.main-menu.expanded {
  width: 250px;
}

.main-menu > ul {
  margin: 7px 0;
  list-style: none;
  padding: 0;
}

.main-menu li {
  width: 250px;
}

.main-menu li > a {
  display: flex;
  align-items: center;
  color: white;
  font-family: Arial, sans-serif;
  font-size: 14px;
  text-decoration: none;
  transition: all 0.2s ease-in-out;
  padding: 8px 0;
}

.main-menu li:hover > a,
.main-menu li.active > a {
  color: #fff;
  background: #435663;
}

.main-menu .nav-icon {
  flex: 0 0 60px;
  text-align: center;
  font-size: 18px;
}

.main-menu .nav-text {
  flex: 1;
  font-family: 'Titillium Web', sans-serif;
}

.main-menu > ul.logout {
  position: absolute;
  bottom: 0;
  left: 0;
}

</style>

<body style="background-image: linear-gradient(90.2deg, #73AF6F -0.4%, #435663 106.1%); color:white; font-family: Trebuchet MS,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Tahoma,sans-serif;">

<div class="area"></div>
<nav class="main-menu">
  <div class="nav-logo" style="text-align:center; padding: 20px 0;">
    <a href="Index.html" style="color:inherit">
      <i class="fa fa-superscript" aria-hidden="true"></i>
    </a>
  </div>

  <ul>
    <li>
      <a href="#">
        <i class="fa fa-home" aria-hidden="true"></i>
        <span class="nav-text">Home</span>
      </a>
    </li>
    <li class="has-subnav">
      <a href="tools.html">
        <i class="fa fa-cube" aria-hidden="true"></i>
        <span class="nav-text">Tasks & Tools</span>
      </a>
    </li>
    <li class="has-subnav">
      <a href="#">
        <i class="fa fa-database" aria-hidden="true"></i>
        <span class="nav-text">DataBase</span>
      </a>
    </li>
    <li class="has-subnav">
      <a href="#">
        <i class="fa fa-circle-o-notch" aria-hidden="true"></i>
        <span class="nav-text">Setting</span>
      </a>
    </li>
  </ul>
</nav>

<H2 style="border-bottom:solid 1px; padding-left:250px;">Welcome Home</h2>

<div style="padding:25px; display:flex; justify-content:right; gap:10%" class="Tranining">
  <div style="padding:10px; border:none 1px; border-radius:25px; background-color:#435663; width:500px">
    <center><h2>Refund Cases</h2></center>
    <center><div id="result" style="color:white; font-size:20px;">Loading...</div></center>
            <center><div style="color:white; font-size:20px;">Pending Action: 102</div></center>
  </div>

  <div style="padding:10px; justify-content:left; border:none 1px; border-radius:25px; background-color:#435663; width:500px">
    <center><h2>Exchange Cases</h2></center>
        <center><div style="color:white; font-size:20px;">Exchange Cases: 242</div></center>
                <center><div style="color:white; font-size:20px;">Exchanges Finished: 132</div></center>
  </div>

  
</div>

<div style="padding:10px; display:flex; justify-content:right;" class="Tranining">
  <div style="padding:10px; border:none 1px; border-radius:25px; background-color:#435663; width:1215px; height:650px;">
    <center><h2>Top Cases</h2></center>

  </div>


  
</div>



</body>
</html>